<% provide(:title, 'Manage Supervisors - PolyU FYP Management') %>
<div class="container">
    <h2 class="display-2" style="margin:1em 0 0.4em 0">Manage Supervisors</h2>
    <% if is_admin? %>
    <h5 class="display-5">You are viewing all supervisors.</h5>
    <% else %>
    <h5 class="display-5">You are viewing supervisors from <%= current_user.department %>.</h5>
    <% end %>
    <br>
    <%= form_for(@supervisor, url: supervisors_path) do |f| %>
        <%= render 'shared/error_messages', obj: @supervisor %>
        <p>Add new supervisor:</p>
        <div class="row">
            <div class="form-group col-md-4">
            <%= f.text_field :name, class: "form-control", placeholder: "enter supervisor name" %>
            </div>
            <div class="form-group col-md-4">
            <%= f.text_field :netID, class: "form-control", placeholder: "enter supervisor netID" %>
            </div>
            <% if is_admin? %>
            <div class="form-group col-md-12">
            <%= f.select :department, @departments_list, {prompt: "Select Department:"}, {class: "form-control"} %>
            </div>
            <% else %>
            <%= f.hidden_field :department, value: current_user.department %>
            <% end %>
        </div>
        <%= f.submit "Create supervisor", class: "btn btn-primary" %>
        <% end %>
    <br>
    <br>
    <table class="table manage-table">
        <thead>
            <tr>
            <th scope="col">#</th>
            <th scope="col">Name</th>
            <th scope="col">NetID</th>
            <th scope="col">Students</th>
            </tr>
        </thead>
        <tbody>
            <% @supervisors.each do |supervisor| %>
                <tr>
                    <th scope="row"><%= supervisor.id %></th>
                    <td><%= supervisor.name %></td>
                    <td><%= supervisor.netID %></td>
                    <td>
                    <div class="row">
                    <% supervisor.students.each do |student| %>
                        <div class="col-md-4">
                        <%= form_for @supervisor, :url => {:action => "removeStudent"} do |f| %>
                            <%= hidden_field_tag :stu_netID, student.netID %>
                            <%= hidden_field_tag :sup_netID, supervisor.netID %>
                            <%= student.name %>
                            <%= f.submit "remove", class: "btn btn-sm btn-white", style: "padding-top:0.1em;border-radius:0.5rem" %>
                        <% end %>
                        </div>
                    <% end %>
                    </div>
                    </td>
                </tr>
            <% end %>
        </tbody>
    </table>
</div>